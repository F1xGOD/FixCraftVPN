<!DOCTYPE html>
<html>
<head>
<title>ADMIN SETTINGS</title>
  <script src="/host.js"></script>
  <script src="/jquery.js"></script>
  <script src="/setup.js"></script>
  <script src="/password.js"></script>
<link rel="icon" href="https://x0.at/CVDX.png">
<style type="text/css">
    p.text { color:#4C4C4C;font-weight:bold;font-family:Calibri;font-size:20 }
    span.deactivated { color:#FF0000;font-weight:bold;font-family:Calibri;font-size:20 }
    span.active { color:#36cc00;font-weight:bold;font-family:Calibri;font-size:20 }
    span.suspended { color:#fc9a08;font-weight:bold;font-family:Calibri;font-size:20 }
</style>
</head>
<body>
<p class="text" id="log">LOADING...</p>
<script>
function checkREADY22(){
if(JSON.stringify(actdata)=="{}"){
  setTimeout(function(){
  checkREADY22()}, 100)
}else{console.log("LOADED!")
document.getElementById('log').innerHTML = `INITIALIZING...`
var uname = getCookie("usernamecred");
var ii2i= 0;
var role = ""
$.getJSON(`https://networkcalc.com/api/encoder/${uname}?encoding=base64`, function (dataa) {uname=dataa.encoded
while (ii2i < actdata.accounts.length){
	if(actdata.accounts[ii2i].username==uname){
		role=actdata.accounts[ii2i].role
	}
	ii2i++
}
var accesslevel = 0
if(role=="debugger"){ accesslevel=2}else{if(role=="moderator"){ accesslevel=3}if(role=="admin"){ accesslevel=4}}
if(role=="admin" || role=="moderator" || role=="debugger"){
	var accountsm = actdata.accounts
	Object.freeze(accountsm)
	var final = ``
	final = `STATUS: ${actdata.status.toUpperCase()}<br>`
	final += `LOGIN ATTEMPTS: ${actdata.tries}<br><br>`
	final += `ACCOUNTS: <br>`
	var accountsm = actdata.accounts
	var accountsdel = actdata.deletedaccounts
	Object.freeze(accountsm)
	var psw = ""	
for (var i = 0; i < accountsm.length; i++) {
    (function(i) { // protects i in an immediately called function
      $.getJSON(`https://networkcalc.com/api/encoder/${accountsm[i].username}?encoding=base64&decode=true`, function (data) {
      $.getJSON(`https://networkcalc.com/api/encoder/${accountsm[i].password}?encoding=base64&decode=true`, function (data2) {
	      						var level = 0
	      						if(accountsm[i].role=="debugger"){ level=2}else{if(accountsm[i].role=="moderator"){ level=3}if(accountsm[i].role=="admin"){ level=4}}
	      						if(accesslevel<level){psw = "********"}else{psw = data2.decoded}
								setTimeout(function(){
        						final += `&nbsp;&nbsp;&nbsp;&nbsp;USERNAME: ${data.decoded}, PASSWORD: ${psw}, ROLE: ${accountsm[i].role.charAt(0).toUpperCase()+accountsm[i].role.slice(1)}, JOB: ${accountsm[i].job.charAt(0).toUpperCase()+accountsm[i].job.slice(1)}, STATUS: <span class=\"${accountsm[i].status}\">${accountsm[i].status.charAt(0).toUpperCase()+accountsm[i].status.slice(1)}</span><br>`},100)
                    if(i==accountsm.length-1){
					setTimeout(function(){
						final+=`TOTAL ${accountsm.length} ACCOUNTS<br><br>`
					final+=`DELETED ACCOUNTS:<br>`
					for (var ii22 = 0; ii22 < accountsdel.length; ii22++) {
    (function(ii22) { // protects i in an immediately called function
      $.getJSON(`https://networkcalc.com/api/encoder/${accountsdel[ii22].username}?encoding=base64&decode=true`, function (data3) {
      $.getJSON(`https://networkcalc.com/api/encoder/${accountsdel[ii22].password}?encoding=base64&decode=true`, function (data4) {
	      						var level2 = 0
	      						if(accountsdel[ii22].role=="debugger"){ level2=2}else{if(accountsdel[ii22].role=="moderator"){ level2=3}if(accountsdel[ii22].role=="admin"){ level2=4}}
	      						if(accesslevel<level2){psw = "********"}else{psw = data4.decoded}
        						final += `&nbsp;&nbsp;&nbsp;&nbsp;USERNAME: ${data3.decoded}, PASSWORD: ${psw}, ROLE: ${accountsdel[ii22].role.charAt(0).toUpperCase()+accountsdel[ii22].role.slice(1)}, JOB: ${accountsdel[ii22].job.charAt(0).toUpperCase()+accountsdel[ii22].job.slice(1)}, REASON: ${accountsdel[ii22].reason}, STATUS: <span class=\"${accountsdel[ii22].status}\">${accountsdel[ii22].status.charAt(0).toUpperCase()+accountsdel[ii22].status.slice(1)}</span><br>`
								if(ii22==accountsdel.length-1){
						setTimeout(function(){
			    	final+=`TOTAL ${accountsdel.length} DELETED ACCOUNTS<br><br>`
					final+=`PAGES UNDER MAINTENANCE:<br>`
					for (var ii2 = 0; ii2 < actdata.undermaintenance.length; ii2++) {
    				(function(ii2) { 
					final+=`&nbsp;&nbsp;&nbsp;&nbsp;PAGE: ${actdata.undermaintenance[ii2].location}, REASON: ${actdata.undermaintenance[ii2].reason}<br>`
                    if(ii2==actdata.undermaintenance.length-1){
						setTimeout(function(){
							final+=`TOTAL ${actdata.undermaintenance.length} PAGES UNDER MAINTENANCE`
							document.getElementById('log').innerHTML = final
						},140)
        			}
      })(ii2)};
	}, 140)
      }
      })});
    })(ii22);
}
					}, 140)
      }
      })});
    })(i);
}
}else{
  window.location.replace(`${host}/forbidden`);
}})}}
checkREADY22();
</script>
</body>
</html>
