<!DOCTYPE html>
<html>
<head>
<title>SESSION VIEWER</title>
  <script src="/host.js"></script>
  <script src="/jquery.js"></script>
  <script src="/setup.js"></script>
  <script src="/password.js" type="module"></script>
  <link rel="stylesheet" href="/snackbar.css">
  <script src="/snackbar.js"></script>
<link rel="icon" href="https://x0.at/CVDX.png">
<style>
  p.text { color:#4C4C4C;font-weight:bold;font-family:Calibri;font-size:20 }
  span.text { color:#4C4C4C;font-weight:bold;font-family:Calibri;font-size:20 }
  span.offline { color:#FF0000;font-weight:bold;font-family:Calibri;font-size:20 }
  span.online { color:#36cc00;font-weight:bold;font-family:Calibri;font-size:20 }
  span.background { color:#fc9a08;font-weight:bold;font-family:Calibri;font-size:20 }
</style>
</head>
<body>
<p id="log" style="margin:0px" class="text">LODAING...</p>
<script type="module">
  function getCookie(cname) {
	let name = cname + "=";
	let decodedCookie = decodeURIComponent(document.cookie);
	let ca = decodedCookie.split(';');
	for(let i = 0; i < ca.length; i++) {
	  let c = ca[i];
	  while (c.charAt(0) == ' ') {
		c = c.substring(1);
	  }
	  if (c.indexOf(name) == 0) {
		return c.substring(name.length, c.length);
	  }
	}
	return "";
  }

function setCookie(cname,cvalue,exdays) {
	const d = new Date();
	d.setTime(d.getTime() + (exdays*24*60*60*1000));
	let expires = "expires=" + d.toUTCString();
	document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}
import { initializeApp} from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";
const firebaseConfig = { apiKey: "AIzaSyAQ89agVS02dwVK9-yWwpZOvMkQWLiKcEM", authDomain: "fixcraft-vpn.firebaseapp.com", databaseURL: "https://fixcraft-vpn-default-rtdb.firebaseio.com", projectId: "fixcraft-vpn", storageBucket: "fixcraft-vpn.appspot.com", messagingSenderId: "811886239981", appId: "1:811886239981:web:9e43da7b31be5f7fb1ace4", measurementId: "G-CTR9TEET9E" };
const app = initializeApp(firebaseConfig);
const db = getDatabase();
var actdata = {};
var sessiondata = {};
const infodat = ref(db, 'data');
onValue(infodat, (snapshot) => {
    const data = snapshot.val();
	  sessiondata=data.session
    actdata=JSON.parse("{"+fwx256unbin(data.data,"G56&.zHIQ")+"}")
  })
  function checkREADY22(fistt){
if(JSON.stringify(actdata)=="{}"){
  setTimeout(function(){
  checkREADY22(true)}, 10)
}else{console.log("LOADED!");
var final= "";
  var result = Object.keys(sessiondata).map((key) => sessiondata[key]);
  for(var ii2 = 0; ii2 < result.length-1; ii2++){
    final+=`USER: ${atob(result[ii2].user)}, IP: ${result[ii2].ip}, LOCATION: ${result[ii2].location}, DATE: ${result[ii2].date+"  "+result[ii2].timestamp} OSInfo: ${result[ii2].OSinfo}, STATUS: <span class=\"${result[ii2].status}\">${result[ii2].status.charAt(0).toUpperCase()+result[ii2].status.slice(1)}</span><br>`
    if(ii2==result.length-2){
      document.getElementById('log').innerHTML=final
    }
  }}}

  function first(){
setTimeout(function(){
	checkREADY22(false)
	first()
},3500)}
var uname = getCookie("usernamecred");
var ii2i= 0;
var role = ""
uname=btoa(uname)
while (ii2i < actdata.accounts.length){
	if(actdata.accounts[ii2i].username==uname){
		role=actdata.accounts[ii2i].role
	}
	ii2i++
}
var accesslevel = 0
if(role=="debugger"){ accesslevel=2}else{if(role=="moderator"){ accesslevel=3}if(role=="admin"){ accesslevel=4}}
if(role=="admin" || role=="moderator" || role=="debugger"){
first();}
</script>
</body>
</html>