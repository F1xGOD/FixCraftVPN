<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="password.css">
	<link rel="icon" href="https://x0.at/3oJC.png">
	<link rel="stylesheet" href="snackbar.css">
	<title>Login to FixCraft</title>
	  <script src="/snackbar.js"></script>
	  <script src="/host.js"></script>
  	  <script src="/jquery.js"></script>
  	  <script src="/setup.js"></script>
  	  <script src="/password.js"></script>
</head>
<body>
	<div class="container" id="container">
		<div class="form-container log-in-container">
			<form action="#">
				<h1>Login</h1>
				<input type="email" id="username" placeholder="Username" />
				<input type="password" id="password" placeholder="Password" />
				<a href="/unknown">Forgot Your Password?</a>
				<script>
	 Object.freeze(actdata)
        function checkCookie() {
          let password = getCookie("passwordcred");
	  let username = getCookie("usernamecred");
	  let triess = getCookie("tries")
	  Object.freeze(triess);
	  Object.freeze(password);
	  Object.freeze(username);
		if (triess==""){
		  setCookie("tries",parseInt(actdata.tries),999999)
	  }else{
		if (triess>0){}else{
			window.location.replace(`${host}/forbidden`)
		}}
	  if(username == "" && password == ""){}else{
	  $.getJSON(`https://networkcalc.com/api/encoder/${username}?encoding=base64`,
            	function (data4) {
			$.getJSON(`https://networkcalc.com/api/encoder/${password}?encoding=base64`,
            		function (data5) {
				Object.freeze(data4);
				Object.freeze(data5);
				var success2 = false
		  		let i = 0;
	    	  		var accountsm = actdata.accounts
		  		Object.freeze(accountsm)
	    	  		while (i < accountsm.length) {
	      				if(accountsm[i].username==data4.encoded&&accountsm[i].password==data5.encoded){
						success2 = true;
					};
					i++;
		  }
                  if(success2==true){
			console.log("Session Login")
	    		window.location.replace(host)  
		  }else{
			snackbar_Fail3();  
		  } 
			})})}      
      }
    
	var snackbar_Success = function () {
                        SnackBar({
                            message: "Logged In Successfully!",
                            status: "success"
                        });
                    };
	function snackbar_Fail(passedvar) {
                        SnackBar({
                            message: `Login Failed! (${passedvar} Attempts Left)`,
                            status: "danger"
                        });
                    };
	function snackbar_Faildela(passedvar) {
                        SnackBar({
                            message: `That Account Was Deleted! (Reason: ${passedvar})`,
                            status: "danger"
                        });
                    };
	function snackbar_Failunact(passedvar) {
                        SnackBar({
                            message: `That Account Was Deactivated! (Reason: ${passedvar})`,
                            status: "danger"
                        });
                    };
	var snackbar_Fail2 = function () {
                        SnackBar({
                            message: "Please Enter Credentials!",
                            status: "danger"
                        });
                    };
	var snackbar_Fail3 = function () {
                        SnackBar({
                            message: "Password Was Changed!",
                            status: "danger"
                        });
                    };
	async function init(){
		setTimeout(function(){
    			window.location.replace(host)
		}, 1000);
		
	}
	function checkSuccess(){
		let tries = getCookie("tries");
	  	Object.freeze(tries);
		var text = document.getElementById("password").value
		var text2 = document.getElementById("username").value
		if(text==""||text2==""){snackbar_Fail2();console.log("LOGIN FAILED!");}else{
		$.getJSON(`https://networkcalc.com/api/encoder/${text}?encoding=base64`,
            	function (data) {
			$.getJSON(`https://networkcalc.com/api/encoder/${text2}?encoding=base64`,
            		function (data2) {
					var succs = false
				        var accounts = actdata.accounts
					var enc = data.encoded
					var enc2 = data2.encoded
					Object.freeze(enc);
	 				Object.freeze(enc2);
					let i2 = 0;
					let successid=0;
					while (i2 < accounts.length) {
						if(accounts[i2].username===enc2&&accounts[i2].password===enc){
							successid=i2
							succs=true
						}else{
							
						};
						i2++;
					}
					if (succs==false){
						let i22 = 0;
					while (i22 < deletedaccounts.length) {
						if(deletedaccounts[i22].username===enc2&&deletedaccounts[i22].password===enc){
							snackbar_Faildela(deletedaccounts[i22].reason)
							console.log("LOGIN FAILED!")
						}else{
						tries=tries-1
						snackbar_Fail(tries);
						setCookie("tries",tries,365)
						console.log("LOGIN FAILED!")} i22++;}
						if(tries>0){}else{
							window.location.replace(`${host}/forbidden`)
						
		     }}else{
						if(accounts[successid].status!="active"){
							snackbar_Failunact(accounts[successid].deactreason);
							console.log("LOGIN FAILED!")
						}else{
							snackbar_Success();
							console.log("LOGIN SUCCEED!");
							setCookie("passwordcred",text,14);
							setCookie("usernamecred",text2,14);
							init();}
						}
					}
				
						
					 
						    
  )})}}
	
	</script>	

				<button type="button" onclick="checkSuccess();">Log In</button>
			</form>
		</div>
		<div class="overlay-container">
			<div class="overlay">
				<div class="overlay-panel overlay-right">
					<h1>Login In FixCraft</h1>
					<p>Keep In mind that shairing passwords is illegal!</p>
				</div>
			</div>
		</div>
	</div>
</body>
</html>
